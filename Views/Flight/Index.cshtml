@model List<Flight>
@{
	ViewData["Title"] = "Flights";}

<div class="container">
	<div class="row justify-content-center">
		<div class="col-md-10">
			<form asp-controller="Flight" asp-action="Search" method="get">
				<div class="search-row">
					<div class="form-group">
						<label for="origin">Origin:</label>
						<div class="input-icon">
							<i class="fa-solid fa-location-dot"></i>
							<input type="text" id="origin" name="origin" class="form-control" placeholder="Origin">
						</div>
					</div>
					<div class="form-group">
						<label for="destination">Destination:</label>
						<div class="input-icon">
							<i class="fa-solid fa-plane"></i>
							<input type="text" id="destination" name="destination" class="form-control" placeholder="Destination">
						</div>
					</div>
					<div class="form-group">
						<label for="departureDate">Departure Date:</label>
						<input type="date" id="departureDate" name="departureDate" class="form-control" placeholder="Departure Date">
					</div>
					<div class="form-group">
						<label for="arrivalDate">Arrival Date:</label>
						<input type="date" id="arrivalDate" name="arrivalDate" class="form-control" placeholder="Arrival Date">
					</div>
				</div>
				<div class="form-group" style="text-align: center; margin-top: 10px; margin-bottom: 20px;">
					<button type="submit" class="btn btn-primary"><i class="fa-solid fa-magnifying-glass"></i> Explore</button>
				</div>
			</form>
		</div>
	</div>
</div>

<div class="container">
	<div class="row justify-content-center">
		<div class="col-md-4">
			<div class="card">
				<div class="card-header">
					<p>Admin View</p>
				</div>
				<div class="card-body">
					<form method="get" asp-action="Index">
						<div class="form-group">
							<label for="email">Email:</label>
							<input type="email" id="email" name="email" class="form-control" required />
						</div>
						@Html.AntiForgeryToken()
						<button type="submit" class="btn btn-primary">View</button>
					</form>
				</div>
			</div>
		</div>
	</div>
</div>

@if (ViewBag.IsAdmin)
{
	<a class="btn btn-primary" style="margin-bottom: 20px;" asp-area="" asp-controller="Flight" asp-action="Create">Create New Flight</a>
}

<div class="card">
	<div class="card-body">
		@if (Model.Any())
		{
			<table class="table">
				<thead>
					<tr>
						<td>Flight Number</td>
						<td>Airline</td>
						<td>Origin</td>
						<td>Destination</td>
						<td>Departure</td>
						<td>Arrival</td>
						<td>Price</td>
						<td>Max Passengers</td>
						<td>Actions</td>
					</tr>
				</thead>
				<tbody>
					@foreach (var flight in Model)
					{
						if (flight.CurrentPassengers < flight.MaxPassengers)
						{
							<tr>
								<td>@flight.FlightNumber</td>
								<td>@flight.Airline</td>
								<td>@flight.Origin</td>
								<td>@flight.Destination</td>
								<td>@flight.DepartureTime</td>
								<td>@flight.ArrivalTime</td>
								<td>@flight.Price</td>
								<td>@flight.MaxPassengers</td>
								<td>
									<a asp-controller="Booking" asp-action="BookFlight" asp-route-id="@flight.FlightId" class="btn btn-primary">Book Flight</a>
									<a asp-action="Details" asp-route-id="@flight.FlightId" class="btn btn-info">Details</a>
									@if (ViewBag.IsAdmin)
									{
										<a asp-action="Edit" asp-route-id="@flight.FlightId" class="btn btn-secondary">Edit</a>
										<a asp-action="Delete" asp-route-id="@flight.FlightId" class="btn btn-danger">Delete</a>
									}									
								</td>
							</tr>
						}
					}
				</tbody>
			</table>
		}
		else
		{
			<p>No flights available.</p>
		}
	</div>
</div>